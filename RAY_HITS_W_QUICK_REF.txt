â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ğŸ“ ray_hits_w API ä»£ç¢¼ä½ç½®å¿«é€Ÿåƒè€ƒ                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ‚¨å•çš„é€™ä¸€è¡Œï¼š
ã€Œâœ… ä½¿ç”¨ ray_hits_w API (2025+ / Sim 5.0) - æ‰‹å‹•è¨ˆç®—è·é›¢ã€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ æ–‡ä»¶ä½ç½®
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å®Œæ•´è·¯å¾‘:
  source/isaaclab_tasks/isaaclab_tasks/manager_based/navigation/
  local_planner/mdp/observations.py

å…·é«”è¡Œè™Ÿ:
  â­ ç¬¬ 44 è¡Œ â­

å‡½æ•¸åç¨±:
  lidar_obs()  (ç¬¬ 21-66 è¡Œ)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ ä»£ç¢¼å…§å®¹ï¼ˆç¬¬ 35-44 è¡Œï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

if hasattr(data, "ray_hits_w") and hasattr(data, "pos_w"):
    # Isaac Sim 5.0+ / Isaac Lab 2025+ï¼šéœ€æ‰‹å‹•è¨ˆç®—è·é›¢
    # ray_hits_w: (num_envs, num_rays, 3) - ä¸–ç•Œåº§æ¨™ä¸­çš„å°„ç·šå‘½ä¸­é»
    # pos_w: (num_envs, 3) - ä¸–ç•Œåº§æ¨™ä¸­çš„æ„Ÿæ¸¬å™¨ä½ç½®
    hit_points = data.ray_hits_w  # (num_envs, num_rays, 3)
    sensor_pos = data.pos_w.unsqueeze(1)  # (num_envs, 1, 3) æ“´å±•ä»¥å»£æ’­
    
    # è¨ˆç®—æ¯æ¢å°„ç·šçš„è·é›¢
    distances = torch.norm(hit_points - sensor_pos, dim=-1)  # (num_envs, num_rays)
    print("âœ… ä½¿ç”¨ ray_hits_w API (2025+ / Sim 5.0) - æ‰‹å‹•è¨ˆç®—è·é›¢")  â† ç¬¬44è¡Œ


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ é€™æ®µä»£ç¢¼çš„ä½œç”¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

åŠŸèƒ½:
  è™•ç† Isaac Sim 5.0 çš„ LiDAR æ„Ÿæ¸¬å™¨æ•¸æ“š
  å› ç‚ºæ–°ç‰ˆ API ä¸å†ç›´æ¥æä¾›è·é›¢ï¼Œéœ€è¦æ‰‹å‹•è¨ˆç®—

è¨ˆç®—é‚è¼¯:
  è·é›¢ = ||å°„ç·šå‘½ä¸­é» - æ„Ÿæ¸¬å™¨ä½ç½®||
  
  1. ç²å–å‘½ä¸­é»: ray_hits_w [num_envs, 360, 3]
  2. ç²å–æ„Ÿæ¸¬å™¨ä½ç½®: pos_w [num_envs, 3]
  3. è¨ˆç®—æ­å¹¾é‡Œå¾—è·é›¢: torch.norm(å·®å€¼)
  4. çµæœ: distances [num_envs, 360]


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” å¿«é€ŸæŸ¥çœ‹å‘½ä»¤
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ç›´æ¥è·³åˆ°ç¬¬44è¡Œ
vim +44 source/isaaclab_tasks/isaaclab_tasks/manager_based/navigation/\
local_planner/mdp/observations.py

# æŸ¥çœ‹æ•´å€‹ lidar_obs å‡½æ•¸ï¼ˆç¬¬21-66è¡Œï¼‰
sed -n '21,66p' source/isaaclab_tasks/isaaclab_tasks/manager_based/navigation/\
local_planner/mdp/observations.py

# æŸ¥çœ‹ ray_hits_w ç›¸é—œä»£ç¢¼ï¼ˆç¬¬35-44è¡Œï¼‰
sed -n '35,44p' source/isaaclab_tasks/isaaclab_tasks/manager_based/navigation/\
local_planner/mdp/observations.py


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ—‚ï¸ å®Œæ•´å‡½æ•¸çµæ§‹
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

observations.py æ–‡ä»¶åŒ…å«:

1. lidar_obs()                      (ç¬¬ 21-66 è¡Œ)  â† ray_hits_w åœ¨é€™è£¡
   â””â”€ è®€å– LiDAR æ•¸æ“šï¼Œå…¼å®¹å¤šç‰ˆæœ¬ API

2. base_lin_vel()                   (ç¬¬ 69-76 è¡Œ)
   â””â”€ æ©Ÿå™¨äººç·šé€Ÿåº¦

3. base_ang_vel()                   (ç¬¬ 79-86 è¡Œ)
   â””â”€ æ©Ÿå™¨äººè§’é€Ÿåº¦

4. goal_position_in_robot_frame()   (ç¬¬ 89-111 è¡Œ)
   â””â”€ ç›®æ¨™ç›¸å°ä½ç½®

5. distance_to_goal()               (ç¬¬ 114-131 è¡Œ)
   â””â”€ åˆ°ç›®æ¨™çš„è·é›¢


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š API ç‰ˆæœ¬å°ç…§
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Isaac Sim 5.0+ (2025+)
  â””â”€ ä½¿ç”¨: ray_hits_w + pos_w
  â””â”€ éœ€è¦: æ‰‹å‹•è¨ˆç®—è·é›¢ âœ… (ç¬¬35-44è¡Œ)
  â””â”€ è¼¸å‡ºä¿¡æ¯: âœ… ä½¿ç”¨ ray_hits_w API (2025+ / Sim 5.0)

Isaac Lab 2025.1
  â””â”€ ä½¿ç”¨: hit_distances
  â””â”€ è¼¸å‡ºä¿¡æ¯: âœ… ä½¿ç”¨ hit_distances API (2025.1)

Isaac Lab 2024.1
  â””â”€ ä½¿ç”¨: distances
  â””â”€ è¼¸å‡ºä¿¡æ¯: âœ… ä½¿ç”¨ distances API (2024.1)

Isaac Lab â‰¤2023.1
  â””â”€ ä½¿ç”¨: ray_distances
  â””â”€ è¼¸å‡ºä¿¡æ¯: âœ… ä½¿ç”¨ ray_distances API (2023.1)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ åœ¨è¨“ç·´ä¸­çš„ä½¿ç”¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

èª¿ç”¨è·¯å¾‘:

train.py
  â†“
Environment.step()
  â†“
ObservationManager.compute()
  â†“
mdp.lidar_obs()  â† åŸ·è¡Œé€™è£¡çš„ä»£ç¢¼
  â†“ (ç¬¬35-44è¡Œè¨ˆç®—è·é›¢)
  â†“
è¿”å› LiDAR æ•¸æ“š [num_envs, 360]
  â†“
çµ„åˆæˆå®Œæ•´è§€æ¸¬ [num_envs, 369]
  â†“
å‚³çµ¦ Neural Network


é…ç½®ä½ç½®:
  local_planner_env_cfg.py (ç¬¬ 166-169 è¡Œ)
  
  lidar_obs = ObsTerm(
      func=mdp.lidar_obs,  â† è¨»å†Šé€™å€‹å‡½æ•¸
      params={"sensor_cfg": SceneEntityCfg("lidar")},
  )


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š ç›¸é—œæ–‡æª”
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è©³ç´°èªªæ˜:
  ğŸ“– RAY_HITS_W_API_LOCATION.md      â† å®Œæ•´èªªæ˜ï¼ˆæ¨è–¦ï¼‰
  ğŸ“– md/RAYCASTER_API_FIX.md         â† API ä¿®å¾©è¨˜éŒ„
  ğŸ“– md/CODE_ARCHITECTURE_GUIDE.md   â† ä»£ç¢¼æ¶æ§‹

å¿«é€Ÿåƒè€ƒ:
  ğŸ“‹ æœ¬æ–‡æª” (RAY_HITS_W_QUICK_REF.txt)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ ç¸½çµ: é€™è¡Œä»£ç¢¼åœ¨ observations.py ç¬¬44è¡Œï¼Œç”¨æ–¼ç¢ºèªæ­£åœ¨ä½¿ç”¨
         Isaac Sim 5.0 çš„æ–° API ä¸¦æ‰‹å‹•è¨ˆç®— LiDAR è·é›¢

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
